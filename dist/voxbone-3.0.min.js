/*!
 * @license Voxbone v3.0.0-b
 * Copyright 2017 Voxbone. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License") 
 */
/** vim: et:ts=4:sw=4:sts=4
 * @license RequireJS 2.3.2 Copyright jQuery Foundation and other contributors.
 * Released under MIT license, https://github.com/requirejs/requirejs/blob/master/LICENSE
 */
function Voxbone(a){function b(a){q.noop=function(){},q.C=C;o=a.connect("https://janus.click2vox.io:9011/"),o.on("connect",function(){q.Logger.loginfo("Connected to Voxbone Janus Server"),q.WebRTC.customEventHandler.connected()}),o.on("disconnect",function(){q.Logger.loginfo("Lost connection to Voxbone Janus Server")}),o.on("connect_error",function(){q.Logger.logerror("Error connecting to Janus Server"),q.WebRTC.customEventHandler.failed({cause:"Connection Error"})}),a.SESSION_EXPIRES=q.C.SESSION_EXPIRES,a.VoxboneLogger={loginfo:function(){var a=Array.prototype.slice.call(arguments);info.apply(console,a)},logerror:function(){var a=Array.prototype.slice.call(arguments);error.apply(console,a)},setError:function(a){error=a},setInfo:function(a){info=a}},a.VoxboneLogger.setInfo(function(){var a=Array.prototype.slice.call(arguments);q.WebRTC.configuration.log_level>=q.Logger.log_level.INFO&&console.log.apply(console,a),5==a.length?(q.Logger.addLogToBuffer("INFO: "+a[0]),q.Logger.addLogToBuffer("INFO: "+a[3])):q.Logger.addLogToBuffer("INFO: "+a[0])}),a.VoxboneLogger.setError=function(){var a=Array.prototype.slice.call(arguments);q.WebRTC.configuration.log_level>=q.Logger.log_level.ERROR&&console.error.apply(console,a),5==a.length?(q.Logger.addLogToBuffer("ERROR: "+a[0]),q.Logger.addLogToBuffer("ERROR: "+a[3])):q.Logger.addLogToBuffer("ERROR: "+a[0])}}function c(a,b){var d=Object.prototype.toString,e=d.call({});for(var f in b)b[f]&&e===d.call(b[f])?(a[f]=a[f]||{},c(a[f],b[f])):a[f]=b[f];return a}function d(a){a="function"==typeof a?a:q.noop,k({request:"getWrapper",id:m(16)},function(b){if("error"===b.response)return void a(b.payload.reason);a(null,b.payload.wrapper)})}function e(a,b){b="function"==typeof b?b:q.noop;try{console.log(s)}catch(a){}s=new WebSocket(a,"voxbone-janus-protocol"),s.onerror=function(a){q.Logger.loginfo("Disconnected from wrapper:",a),s=null,b(a)},s.onclose=function(){q.Logger.loginfo("Disconnected from wrapper (closed)"),s=null,("function"==typeof r.callbacks.disconnectedWrapper?r.callbacks.disconnectedWrapper:q.noop)()},s.onmessage=function(a){q.Logger.loginfo(a);var b=JSON.parse(a.data),c=b.id;if(c){var d=y[c];d&&d(b),delete y[c]}else{var e=b.event;if("hangup"===e){q.Logger.loginfo("Hangup/decline event");("function"==typeof r.callbacks.hangup?r.callbacks.hangup:q.noop)(),q.WebRTC.hangup(!0)}else if("incomingcall"===e){var f=b.payload,g=f.caller,i=f.jsep,j=i.sdp.indexOf("m=video ")>-1||!1;q.Logger.loginfo("Incoming "+(j?"video":"audio")+" call from "+g),q.WebRTC.rtcSession.status=q.C.STATUS_INVITE_RECEIVED,h(function(a){if(a&&!u)return q.WebRTC.hangup(),void q.Logger.logerror(a);u.setRemoteDescription(new RTCSessionDescription(i),function(){q.Logger.loginfo("Remote description accepted!"),("function"==typeof r.callbacks.incomingcall?r.callbacks.incomingcall:q.noop)(g,j)},function(a){q.WebRTC.hangup(),q.Logger.logerror(a)})})}else if("losses"===e){var f=b.payload;q.Logger.loginfo("Losses event:",f);var k="function"==typeof r.callbacks.losses?r.callbacks.losses:q.noop;k(f)}else if("missedcalls"===e){var l=b.payload;q.Logger.loginfo("Missed calls event:",l);var m="function"==typeof r.callbacks.missedcalls?r.callbacks.missedcalls:q.noop;m(l)}else"webrtc"===e&&"up"===b.payload.status?q.WebRTC.rtcSession.isEstablished=!0:q.Logger.loginfo("Unhandled event "+e+": "+b.payload.status)}},s.onopen=function(){b()}}function f(a,b){b="function"==typeof b?b:q.noop,q.Logger.loginfo("Details:"),q.Logger.loginfo(a),l({request:"register",id:m(16),payload:a},function(a){if("error"===a.response)return b(a.payload.reason),void q.WebRTC.customEventHandler.failed(a.payload.reason);q.WebRTC.customEventHandler.registered(a),b()})}function g(){l({request:"unregister",id:m(16)},function(a){s&&s.close(),s=null})}function h(a){if(a="function"==typeof a?a:q.noop,q.Logger.loginfo("Creating Peerconnection!"),u)return q.Logger.loginfo("PeerConnection exists"),void a("PeerConnection exists");var b=q.WebRTC.getOptions(),c=b.pcConfig.iceServers||x;console.log(c);var d={optional:[{DtlsSrtpKeyAgreement:!0}]};u=new RTCPeerConnection(c,d),q.Logger.loginfo(u),u.onaddstream=function(a){("function"==typeof r.callbacks.stream?r.callbacks.stream:q.noop)(a.stream)},u.onicecandidate=function(a){var b=null;b=null===a.candidate?{completed:!0}:{candidate:a.candidate.candidate,sdpMid:a.candidate.sdpMid,sdpMLineIndex:a.candidate.sdpMLineIndex},q.Logger.loginfo("Trickling candidate:",b),l({request:"trickle",id:m(16),payload:{candidate:b}})},a()}function j(a,b){if(b="function"==typeof b?b:q.noop,!u)return q.Logger.loginfo("Not invited to a call"),void b("Not invited to a call");var c="function"==typeof r.callbacks.consent?r.callbacks.consent:q.noop;c(!0),navigator.mediaDevices.getUserMedia({audio:!0,video:a}).then(function(d){c(!1),t=d,q.WebRTC.rtcSession.connection.localStreams.push(t),q.WebRTC.monitorStreamVolume("local"),u.addStream(d),("function"==typeof r.callbacks.preview?r.callbacks.preview:q.noop)(d);var e=null;e="firefox"==p.browserDetails.browser||"edge"==p.browserDetails.browser?{offerToReceiveAudio:!0,offerToReceiveVideo:a}:{mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:a}},q.Logger.loginfo(e),u.createAnswer(function(a){if(!0===w)return void q.Logger.loginfo("Offer already sent, not sending it again");w=!0,u.setLocalDescription(a);var c={type:a.type,sdp:a.sdp},d={request:"accept",id:m(16),payload:{jsep:c}};q.WebRTC.rtcSession.status=q.C.STATUS_ANSWERED,l(d,function(a){if(q.Logger.loginfo("Got ack to answer"),"error"===a.response)return q.WebRTC.hangup(),q.Logger.loginfo(a.payload.reason),void b(a.payload.reason);q.WebRTC.rtcSession.status=q.C.STATUS_CONFIRMED,b()})},function(a){q.WebRTC.hangup(),q.Logger.logerror(a),b(a)},e)}).catch(function(a){c(!1),q.Logger.logerror(a),b(a)})}function k(a,b){if(b="function"==typeof b?b:q.noop,!o)return void b({response:"error",payload:{reason:"Invalid socket/wrapper"}});a.id||(a.id=m(16)),q.Logger.loginfo("Sending message to Frontend:"),q.Logger.loginfo(a);var c=a.id;o.on(c,function(a){q.Logger.loginfo("Received response from Frontend:"),q.Logger.loginfo(a),q.Logger.loginfo(a.payload),o.removeListener(c,arguments.callee),b&&b(a)}),o.emit("message",a)}function l(a,b){if(b="function"==typeof b?b:q.noop,!s)return void b({response:"error",payload:{reason:"Invalid wrapper"}});a.id||(a.id=m(16)),q.Logger.loginfo("Sending message to Wrapper:"),q.Logger.loginfo(a),y[a.id]=b,setTimeout(function(){s.send(JSON.stringify(a))},200)}function m(a){charSet="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(var b="",c=0;c<a;c++){var d=Math.floor(Math.random()*charSet.length);b+=charSet.substring(d,d+1)}return b}var n,o,p,q={};requirejs.config({paths:{io:"//cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.3/socket.io",adapter:["//cdn.temasys.com.sg/adapterjs/0.14.3/adapter.min","//cdnjs.cloudflare.com/ajax/libs/adapterjs/0.14.3/adapter.min"],callstats:["//cdn.voxbone.com/lib/callstats-3.21.1.min","//api.callstats.io/static/callstats-3.21.1.min"]}}),requirejs(["io","adapter","callstats"],function(a,c,d){b(a),n=a,p=c,q.WebRTC.callStats=d});var r=this,s=null,t=null,u=null,v=null,w=!1,x={iceServers:[{url:"stun:stun.l.google.com:19302"}]};c(q,{Request:{param:function(a){var b="";for(var c in a)a.hasOwnProperty(c)&&(b.length>0&&(b+="&"),b+=c+"="+encodeURIComponent(a[c]));return b},post:function(a,b,c){var d=new XMLHttpRequest,e=this.param(b);d.open("POST",a),d.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),d.onload=function(){"function"==typeof c&&c({status:d.status,message:d.responseText})},q.Logger.loginfo(e),d.send(e)},jsonp:function(a,b,c){var d=a+(a.indexOf("?")+1?"&":"?");d+=this.param(b);var e="jsonp_callback_"+Math.round(1e5*Math.random()),f=document.createElement("script");f.src=d+"&jsonp="+e,window[e]=function(a){delete window[e],f.parentNode.removeChild(f),clearTimeout(g),c(a)};var g=setTimeout(function(){c({error:q.C.AUTHENTICATION_ERROR})},q.WebRTC.authenticationTimeout);document.getElementsByTagName("head")[0].appendChild(f)}}}),c(q,{Pinger:{pingResults:[],ping:function(a,b){var c=(new Date).getTime(),d=this,e=this.recordPingResult;this.img=new Image,d.inUse=!0,this.img.onload=function(){var b=(new Date).getTime()-c;e(a,b),d.inUse=!1},this.img.onerror=function(b){d.inUse=!1,e(a,-1)},this.img.src=b+"?"+(new Date).getTime(),this.timer=setTimeout(function(){d.inUse&&(d.inUse=!1,e(a,-1))},1500)},recordPingResult:function(a,b){q.Logger.loginfo("[ping] "+a+" replied in "+b);var c={name:a,ping:b};q.Pinger.pingResults.push(c)},getBestPop:function(){var a;if(0===this.pingResults.length)a={name:"BE",ping:-1};else for(var b=0;b<this.pingResults.length;b++){var c=this.pingResults[b];(void 0===a||c.ping>0&&(a.ping<0||c.ping<a.ping))&&(a=c)}return a}}}),c(q,{Logger:{loginfo:function(a){q.WebRTC.configuration.log_level>=q.Logger.log_level.INFO&&console.log(a),q.Logger.addLogToBuffer("INFO: "+a)},logerror:function(a){q.WebRTC.configuration.log_level>=q.Logger.log_level.ERROR&&console.log(a),q.Logger.addLogToBuffer("ERROR: "+a)},addLogToBuffer:function(a){q.WebRTC.webrtcLogs=q.WebRTC.webrtcLogs.concat("\r\n"),q.WebRTC.webrtcLogs=q.WebRTC.webrtcLogs.concat(a)},log_level:{NONE:0,ERROR:1,INFO:2}}}),c(q,{WebRTC:{callStats:void 0,audioComponentName:"peer-audio",videoComponentName:"peer-video",allowVideo:!1,authServerURL:"https://cdn.voxbone.com/authentication/createToken",basicAuthServerURL:"https://cdn.voxbone.com/authentication/basicToken",authenticationTimeout:3e3,webrtcLogs:"",rtcSession:{connection:{localStreams:[],remoteStreams:[]},status:0},callid:"",previous_callid:"",audioContext:void 0,localVolume:0,remoteVolume:0,localVolumeTimer:void 0,remoteVolumeTimer:void 0,dtmfTimer:void 0,localAudioScriptProcessor:{},remoteAudioScriptProcessor:{},preferedPop:void 0,inboundCalling:!1,register:!1,username:null,password:null,onCall:null,configuration:{connectionId:void 0,username:this.username,authuser:this.authuser,secret:this.secret,guestUser:!1,server:this.server,uri:this.uri||"sip:undefined@voxbone.com",customer:this.customer||"voxbone_webrtcventures",ws_servers:void 0,stun_servers:void 0,turn_servers:void 0,log_level:2,post_logs:!1,post_logs_nocall:!0,webrtc_log:void 0,trace_sip:!0,register:!1,dialer_string:void 0,digit_duration:100,digit_gap:500,headers:{}},customEventHandler:{progress:function(a){},accepted:function(a){},getUserMediaFailed:function(a){q.Logger.logerror("Failed to access mic/camera")},localMediaVolume:function(a){},remoteMediaVolume:function(a){},failed:function(a){q.Logger.logerror(a)},ended:function(a){},authExpired:function(a){},readyToCall:function(a){},getUserMediaAccepted:function(a){q.Logger.loginfo("local media accepted")},connected:function(a){},registered:function(a){}},phone:void 0,context:void 0,init:function(a){q.Logger.loginfo("auth server: "+this.authServerURL),q.WebRTC.configuration.customer=a.username;var b={username:a.username,key:a.key,expires:a.expires,timestamp:Date.now()},c=this;q.Request.jsonp(this.authServerURL,b,function(a){q.WebRTC.processAuthData(c,a)})},basicAuthInit:function(a,b){q.Logger.loginfo("auth server: "+this.basicAuthServerURL),q.WebRTC.configuration.customer=a;var c={username:a,key:b,timestamp:Date.now()},d=this;q.Request.jsonp(this.basicAuthServerURL,c,function(a){q.WebRTC.processAuthData(d,a)})},processAuthData:function(a,b){if(b.connectionId)a.configuration.connectionId=b.connectionId,a.configuration.username=b.username;else if(b.error)this.customEventHandler.failed({cause:b.error});else{a.configuration.stun_servers=b.stunServers,a.configuration.turn_servers=b.turnServers,a.configuration.webrtc_log=b.log,a.configuration.username=b.username,a.configuration.authuser=b.username,a.configuration.secret=b.password,q.WebRTC.onCall instanceof Function!=!0&&function(){if(void 0===a.preferedPop){q.Logger.loginfo("prefered pop undefined, pinging...."),this.pingServers=b.pingServers;for(var c=0;c<Object.keys(this.pingServers).length;c++){var d=Object.keys(this.pingServers)[c];q.Pinger.ping(d,this.pingServers[d])}}else q.Logger.loginfo("preferred pop already set to "+a.preferedPop)}(),function(a){var b=a.getAuthExpiration();b>0&&(q.Logger.loginfo("Credential expires in "+b+" seconds"),setTimeout(a.customEventHandler.authExpired,750*b))}(a);var c=b.callStatsCredentials,d=function(a,b){q.Logger.loginfo("callStats Status: errCode = "+a+" Msg = "+b)},e=b.username.split(":")[1];q.WebRTC.callStats.initialize(c.appId,c.appSecret,e,d,null,null)}q.WebRTC.onCall instanceof Function&&!q.WebRTC.phone&&(this.inboundCalling=!0,this.configuration.register=!0,this.setupInboundCalling(a.configuration,function(a){a&&(q.Logger.logerror("Registration failed:"),q.Logger.logerror(a))})),this.customEventHandler.readyToCall()},getAuthExpiration:function(a){var b=Math.floor((new Date).getTime()/1e3);return this.configuration.username.split(/:/)[0]-b},initAudioElement:function(a,b){var c=document.getElementById(a);return c||(c=document.createElement("audio"),c.id=a,c.hidden=!1,c.autoplay=!0,document.body.appendChild(c)),c.src=(window.URL?URL:webkitURL).createObjectURL(b),c},initVideoElement:function(a,b){var c=document.getElementById(a);return c||(c=document.createElement("video"),c.id=a,c.hidden=!1,c.autoplay=!0,document.body.appendChild(c)),c.src=(window.URL?URL:webkitURL).createObjectURL(b),c},sendPreConfiguredDtmf:function(a){var b,c=0;if(void 0!==q.WebRTC.dtmfTimer&&(clearTimeout(q.WebRTC.dtmfTimer),q.WebRTC.dtmfTime=void 0),a.length>0){if(-1!=a[0].indexOf("ms")?c=parseInt(a[0].substring(0,a[0].indexOf("ms"))):b=a[0],a=a.slice(1,a.length),void 0!==b){Date.now();q.WebRTC.sendDTMF(b),!0}if(a.length>0){var d=c>0?c-q.WebRTC.configuration.digit_gap:q.WebRTC.configuration.digit_gap+q.WebRTC.configuration.digit_duration;d<0&&(d=0),q.WebRTC.dtmfTimer=setTimeout(function(){q.WebRTC.sendPreConfiguredDtmf(a)},d)}}},postCallRating:function(a,b,c,d,e){if(void 0!==q.WebRTC.previous_callid){var f={payload_type:"webrtc_call_rating",username:q.WebRTC.configuration.authuser,password:q.WebRTC.configuration.password,callid:q.WebRTC.previous_callid,e164:a,button_id:e,url:d,rating:b,comment:c},g=q.WebRTC.configuration.webrtc_log;q.Request.post(g,f),q.WebRTC.previous_callid=void 0}},postLogsToServer:function(){if(!0===q.WebRTC.configuration.post_logs&&void 0!==q.WebRTC.configuration.webrtc_log){var a=q.WebRTC.configuration.webrtc_log,b={payload_type:"webrtc_logs",username:q.WebRTC.configuration.authuser,password:q.WebRTC.configuration.password,callid:q.WebRTC.callid,pop:q.WebRTC.preferedPop,context:q.WebRTC.context,uri:q.WebRTC.configuration.uri,logs:q.WebRTC.webrtcLogs};q.Request.post(a,b)}},cleanUp:function(){["local","remote"].forEach(function(a){void 0!==q.WebRTC[a+"VolumeTimer"]&&(clearInterval(q.WebRTC[a+"VolumeTimer"]),q.WebRTC[a+"VolumeTimer"]=void 0);var b=a+"AudioScriptProcessor";if(void 0!==q.WebRTC[b]){if(void 0!==q.WebRTC.audioContext&&void 0!==q.WebRTC.audioContext.destination)try{q.WebRTC[b].disconnect(q.WebRTC.audioContext.destination)}catch(a){}q.WebRTC[b]=void 0}}),void 0!==q.WebRTC.dtmfTimer&&(clearTimeout(q.WebRTC.dtmfTimer),q.WebRTC.dtmfTimer=void 0),q.WebRTC.cleanAudioElement(q.WebRTC.audioComponentName),q.WebRTC.previous_callid=q.WebRTC.callid,q.WebRTC.callid="",q.WebRTC.webrtcLogs="",q.WebRTC.rtcSession.connection.localStreams=[],q.WebRTC.rtcSession.connection.remoteStreams=[],t=null,v=null,u=null,w=!1,q.WebRTC.rtcSession.isInProgress=!1,q.WebRTC.rtcSession.isEstablished=!1,q.WebRTC.inboundCalling||delete q.WebRTC.phone},cleanAudioElement:function(a){var b=document.getElementById(a);return b&&(b.removeAttribute("src"),b.load()),b},monitorStreamVolume:function(a){a=a||"local",q.Logger.loginfo("monitoring volume on "+a);var b="local"===a?q.WebRTC.rtcSession.connection.localStreams:q.WebRTC.rtcSession.connection.remoteStreams,c="local"===a?"localVolume":"remoteVolume",d="local"===a?"localVolumeTimer":"remoteVolumeTimer",e="local"===a?"localMediaVolume":"remoteMediaVolume",f="local"===a?"localAudioScriptProcessor":"remoteAudioScriptProcessor",g=b;q.Logger.loginfo(g),q.Logger.loginfo(a+" streams: "+g.length);for(var h=0;h<g.length;h++)if(g[h].getAudioTracks().length>0){try{void 0===q.WebRTC.audioContext&&(q.WebRTC.audioContext=new AudioContext)}catch(a){q.Logger.logerror("Web Audio API not supported "+a)}q.WebRTC[f]=q.WebRTC.audioContext.createScriptProcessor(0,1,1);var i=q.WebRTC.audioContext.createMediaStreamSource(g[h]);i.connect(q.WebRTC[f]),q.WebRTC[f].connect(q.WebRTC.audioContext.destination),q.WebRTC[f].onaudioprocess=function(a){var b,d=a.inputBuffer.getChannelData(0),e=0;for(b=0;b<d.length;++b)e+=d[b]*d[b];q.WebRTC[c]=Math.sqrt(e/d.length)},q.WebRTC[d]=setInterval(function(){var a={};a[c]=q.WebRTC[c].toFixed(2),q.WebRTC.customEventHandler[e](a)},200);break}},getOptions:function(){var a={eventHandlers:{peerconnection:function(a){},sending:function(a){q.callid=a.request.call_id;var b=q.WebRTC.rtcSession.connection.pc,c=q.WebRTC.rtcSession.remote_identity.uri.user;q.callStats.addNewFabric(b,c,q.callStats.fabricUsage.audio,q.callid,null)},progress:function(a){q.WebRTC.customEventHandler.progress(a)},failed:function(a){var b,c=q.WebRTC.callid,d=q.WebRTC.callStats;switch(q.Logger.logerror("Call ("+c+") failed. Cause: "+a.cause),void 0!==q.WebRTC.rtcSession.connection&&q.WebRTC.rtcSession.connection&&(b=q.WebRTC.rtcSession.connection.pc),a.cause){case"User Denied Media Access":"object"==typeof b&&d.reportError(b,c,d.webRTCFunctions.getUserMedia),q.WebRTC.customEventHandler.getUserMediaFailed(a);break;case"INCOMPATIBLE_SDP":case"MISSING_SDP":"object"==typeof b&&d.reportError(b,c,d.webRTCFunctions.createOffer);break;case"bye":case"CANCELED":case"NO_ANSWER":case"EXPIRES":case"NO_ACK":case"BUSY":case"REJECTED":case"REDIRECTED":case"UNAVAILABLE":case"Error calling: 404 Not Found":"object"==typeof b&&d.reportError(b,c,d.webRTCFunctions.applicationError),a.cause="Not Found";break;default:"object"==typeof b&&d.reportError(b,c,d.webRTCFunctions.signalingError)}q.WebRTC.postLogsToServer(),q.WebRTC.cleanUp(),q.WebRTC.customEventHandler.failed(a)},accepted:function(a){q.WebRTC.customEventHandler.accepted(a)},addstream:function(a){q.WebRTC.monitorStreamVolume("local"),q.WebRTC.monitorStreamVolume("remote"),q.WebRTC.allowVideo?q.WebRTC.initVideoElement(q.WebRTC.videoComponentName,a.stream):q.WebRTC.initAudioElement(q.WebRTC.audioComponentName,a.stream)},confirmed:function(a){if(q.WebRTC.rtcSession.status=q.C.STATUS_CONFIRMED,void 0!==q.WebRTC.configuration.dialer_string&&q.WebRTC.configuration.dialer_string.length>0){var b=q.WebRTC.configuration.dialer_string.split(",");q.WebRTC.sendPreConfiguredDtmf(b)}},ended:function(a){q.WebRTC.postLogsToServer(),q.WebRTC.cleanUp(),q.WebRTC.customEventHandler.ended(a)}},pcConfig:{rtcpMuxPolicy:"negotiate"},mediaConstraints:{audio:!0,video:q.WebRTC.allowVideo}};if(void 0!==this.configuration.stun_servers||void 0!==this.configuration.turn_servers){var b=[];for(i=0;i<this.configuration.stun_servers.length;i++)b.push(this.configuration.stun_servers[i]);for(i=0;i<this.configuration.turn_servers.length;i++)b.push(this.configuration.turn_servers[i]);a.pcConfig.iceServers={iceServers:b.slice(0,4)},a.pcConfig.gatheringTimeoutAfterRelay=5e3}return a.pcConfig.iceCandidatePoolSize=10,a},setupInboundCalling:function(a,b){b="function"==typeof b?b:q.noop,q.Logger.loginfo(a),s&&s.close(),d(function(c,d){if(c)return void b(c);q.Logger.loginfo(d);var h=null;h="https:"===window.location.protocol?d.usersApi.https:d.usersApi.http,q.Logger.loginfo(h),e(h,function(c){if(c)return g(),void b(c);f(a,function(a,c){a&&g(),b(a,c),q.WebRTC.rtcSession.isInProgress=!0,r.on("consent",function(a){a&&q.WebRTC.customEventHandler.getUserMediaAccepted()}),r.on("incomingcall",function(a,b){q.WebRTC.onCall(a,function(a){a?j(b,function(a){if(a)return q.Logger.logerror(a),void q.WebRTC.cleanup()}):q.WebRTC.hangup()})}),r.on("stream",function(a){q.WebRTC.rtcSession.connection.remoteStreams.push(a),q.WebRTC.monitorStreamVolume("remote"),q.WebRTC.allowVideo?q.WebRTC.initVideoElement(q.WebRTC.videoComponentName,a):q.WebRTC.initAudioElement(q.WebRTC.audioComponentName,a)})})})})},call:function(a,b,c){function i(){if(c="function"==typeof c?c:q.noop,u)return q.Logger.loginfo("Already in a call"),void c("Already in a call");h(function(a){if(a&&!u)return void c("Error creating PeerConnection");var d="function"==typeof r.callbacks.consent?r.callbacks.consent:q.noop;d(!0),navigator.mediaDevices.getUserMedia({audio:!0,video:b}).then(function(a){t=a,q.WebRTC.rtcSession.connection.localStreams.push(t),q.WebRTC.monitorStreamVolume("local"),u.addStream(a),("function"==typeof r.callbacks.preview?r.callbacks.preview:q.noop)(a),j(u)}).catch(function(a){d(!1),q.WebRTC.getOptions().eventHandlers.failed({cause:a}),c(a)})})}function j(a){var d=null;d="firefox"==p.browserDetails.browser||"edge"==p.browserDetails.browser?{offerToReceiveAudio:!0,offerToReceiveVideo:b}:{mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:b}},q.Logger.loginfo(d),q.WebRTC.rtcSession.isInProgress=!0,a.createOffer(function(b){if(!0===w)return void q.Logger.loginfo("Offer already sent, not sending it again");w=!0,a.setLocalDescription(b);var c={type:b.type,sdp:b.sdp},d={request:"invite",id:m(16),payload:{callee:o,jsep:c,authuser:s,secret:v}};q.WebRTC.rtcSession.status=q.C.STATUS_WAITING_FOR_ACK,l(d,function(b){k(a,b)})},function(a){q.WebRTC.hangup(),q.WebRTC.getOptions().eventHandlers.failed({cause:a}),c(a)},d)}function k(a,b){if(q.Logger.loginfo("Got answer to offer:",b),"error"===b.response){c(b.payload.reason);return q.WebRTC.getOptions().eventHandlers.failed({cause:b.payload.reason}),void q.WebRTC.hangup()}var d=b.payload.jsep;q.Logger.loginfo(d),q.WebRTC.rtcSession.status=q.C.STATUS_ANSWERED,a.setRemoteDescription(new RTCSessionDescription(d),function(){q.Logger.loginfo("Remote description accepted!");var a=q.WebRTC.getOptions();a.eventHandlers.accepted(),a.eventHandlers.confirmed(),c()},function(a){q.WebRTC.hangup(),q.WebRTC.getOptions().eventHandlers.failed({cause:a}),c(a)})}if(q.WebRTC.isCallOpen())return void q.Logger.loginfo("Already in a call");console.log("start call to "+a),void 0===q.WebRTC.preferedPop&&(q.WebRTC.preferedPop=q.Pinger.getBestPop().name),q.Logger.loginfo("prefered pop: "+q.WebRTC.preferedPop);var n={};n["X-Voxbone-Pop"]=q.WebRTC.preferedPop,this.context&&(n["X-Voxbone-Context"]=this.context),q.WebRTC.configuration.headers=n,q.WebRTC.configuration.guestUser=!0;var o="sip:"+a+"@voxout.voxbone.com",s=q.WebRTC.configuration.authuser,v=q.WebRTC.configuration.secret;this.phone=!0,d(function(a,b){if(a)return void q.Logger.logerror(a);q.Logger.loginfo(b);var c=null;c="https:"===window.location.protocol?b.usersApi.https:b.usersApi.http,q.Logger.loginfo(c),e(c,function(a){f(q.WebRTC.configuration,function(a,b){a&&g(),q.WebRTC.rtcSession.isInProgress=!0,r.on("consent",function(a){a?q.WebRTC.customEventHandler.getUserMediaAccepted():q.WebRTC.customEventHandler.failed({cause:"User Denied Media Access"})}),i()})})}),r.on("stream",function(a){q.WebRTC.rtcSession.connection.remoteStreams.push(a),q.WebRTC.monitorStreamVolume("remote"),q.WebRTC.allowVideo?q.WebRTC.initVideoElement(q.WebRTC.videoComponentName,a):q.WebRTC.initAudioElement(q.WebRTC.audioComponentName,a)})},isCallOpen:function(){return!0===q.WebRTC.rtcSession.isInProgress||!0===q.WebRTC.rtcSession.isEstablished},sendDTMF:function(a){if(q.WebRTC.isCallOpen())if(-1===String(" ABCD0123456789#*").indexOf(a))q.Logger.logerror("Invalid tone");else if("chrome"===p.browserDetails.browser){if(!v){if(t){var b=t.getAudioTracks();if(b&&b.length>0){var c=b[0];v=u.createDTMFSender(c),console.log("Created DTMF Sender"),v.ontonechange=function(a){console.debug("Sent DTMF tone: "+a.tone)}}}if(!v||!a)return void console.warn("Invalid DTMF configuration")}var d=q.WebRTC.configuration.digit_duration,e=q.WebRTC.configuration.digit_gap;console.debug("Sending DTMF string "+a+" (duration "+d+"ms, gap "+e+"ms)"),v.insertDTMF(a,d,e)}else{var f={request:"dtmf",id:m(16),payload:{tone:a}};l(f,function(a){if("error"===a.response)return void q.Logger.logerror(a.payload.reason)})}else q.Logger.logerror("call has not started")},hangup:function(a){if(0!==Object.keys(this.rtcSession).length){if(q.WebRTC.rtcSession.status===q.C.STATUS_NULL)q.Logger.logerror("call has not started");else if(q.WebRTC.rtcSession.status!==q.C.STATUS_TERMINATED){var b="function"==typeof r.callbacks.preview?r.callbacks.preview:q.noop;b(null),t&&(q.Logger.loginfo("Stopping local stream"),function(a){try{a.id.stop()}catch(a){}try{var b=a.getTracks();for(var c in b){var d=b[c];d&&d.stop()}}catch(a){}}(t));try{u.close()}catch(a){}if(!a){var c={request:"hangup",id:m(16)};l(c)}q.WebRTC.customEventHandler.ended("hangup"),q.WebRTC.rtcSession.status=q.C.STATUS_TERMINATED}q.WebRTC.cleanUp()}},attachMediaStream:function(a,b){if("chrome"===p.browserDetails.browser){p.browserDetails.version>=43?a.srcObject=b:void 0!==a.src?a.src=URL.createObjectURL(b):console.error("Error attaching stream to element")}else a.srcObject=b},reattachMediaStream:function(a,b){if("chrome"===p.browserDetails.browser){p.browserDetails.version>=43?a.srcObject=b.srcObject:void 0!==a.src&&(a.src=b.src)}else a.srcObject=b.srcObject},mediaInfo:function(a){a="function"==typeof a?a:q.noop,l({request:"mediaInfo",id:m(16)},function(b){if("error"===b.response)return void a(b.payload.reason);a(null,b.payload.info)})},isWebRTCSupported:function(){if(window.navigator.webkitGetUserMedia||window.navigator.mozGetUserMedia){if(navigator.userAgent.toLowerCase().indexOf("firefox")>-1){var a=new RegExp("firefox/([0-9])+"),b=new RegExp("([0-9])+"),c=a.exec(navigator.userAgent.toLowerCase())[0];if(b.exec(c)[0]<23)return!1}return!0}return!1},isMuted:!1,isRemoteMuted:!1,mute:function(a){var b;a&&"remote"===a?(b=q.WebRTC.rtcSession.connection.remoteStreams,this.isRemoteMuted=!0):(b=q.WebRTC.rtcSession.connection.localStreams,this.isMuted=!0);for(var c=0;c<b.length;c++)for(var d=0;d<b[c].getAudioTracks().length;d++)b[c].getAudioTracks()[d].enabled=!1},unmute:function(a){var b;a&&"remote"===a?(b=q.WebRTC.rtcSession.connection.remoteStreams,this.isRemoteMuted=!1):(b=q.WebRTC.rtcSession.connection.localStreams,this.isMuted=!1);for(var c=0;c<b.length;c++)for(var d=0;d<b[c].getAudioTracks().length;d++)b[c].getAudioTracks()[d].enabled=!0},unloadHandler:function(){q.WebRTC.isCallOpen?(q.Logger.loginfo("Page unloading while a call was in progress, hanging up"),q.WebRTC.hangup(),q.WebRTC.postLogsToServer()):!0===q.WebRTC.configuration.post_logs_nocall&&q.WebRTC.postLogsToServer()}}}),this.callbacks={},this.on=function(a,b){r.callbacks[a]=b};var y={};return a&&(a.sipUsername&&(q.WebRTC.configuration.username=a.sipUsername),a.sipAuthUser&&(q.WebRTC.configuration.authuser=a.sipAuthUser||a.sipUsername),a.sipPassword&&(q.WebRTC.configuration.secret=a.sipPassword),a.sipUsername&&a.sipRegistrar&&(q.WebRTC.configuration.uri="sip:"+a.sipUsername+"@"+a.sipRegistrar),a.sipURI&&(q.WebRTC.configuration.uri=a.sipURI),a.sipRegistrar&&(q.WebRTC.configuration.server="sip:"+a.sipRegistrar),a.log_level&&(q.WebRTC.configuration.log_level=a.log_level||q.Logger.log_level.INFO),a.post_logs&&(q.WebRTC.configuration.post_logs=a.post_logs||q.WebRTC.configuration.post_logs)),q}var requirejs,require,define;!function(global,setTimeout){function commentReplace(a,b){return b||""}function isFunction(a){return"[object Function]"===ostring.call(a)}function isArray(a){return"[object Array]"===ostring.call(a)}function each(a,b){if(a){var c;for(c=0;c<a.length&&(!a[c]||!b(a[c],c,a));c+=1);}}function eachReverse(a,b){if(a){var c;for(c=a.length-1;c>-1&&(!a[c]||!b(a[c],c,a));c-=1);}}function hasProp(a,b){return hasOwn.call(a,b)}function getOwn(a,b){return hasProp(a,b)&&a[b]}function eachProp(a,b){var c;for(c in a)if(hasProp(a,c)&&b(a[c],c))break}function mixin(a,b,c,d){return b&&eachProp(b,function(b,e){!c&&hasProp(a,e)||(!d||"object"!=typeof b||!b||isArray(b)||isFunction(b)||b instanceof RegExp?a[e]=b:(a[e]||(a[e]={}),mixin(a[e],b,c,d)))}),a}function bind(a,b){return function(){return b.apply(a,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(a){throw a}function getGlobal(a){if(!a)return a;var b=global;return each(a.split("."),function(a){b=b[a]}),b}function makeError(a,b,c,d){var e=new Error(b+"\nhttp://requirejs.org/docs/errors.html#"+a);return e.requireType=a,e.requireModules=d,c&&(e.originalError=c),e}function newContext(a){function b(a){var b,c;for(b=0;b<a.length;b++)if("."===(c=a[b]))a.splice(b,1),b-=1;else if(".."===c){if(0===b||1===b&&".."===a[2]||".."===a[b-1])continue;b>0&&(a.splice(b-1,2),b-=2)}}function c(a,c,d){var e,f,g,h,i,j,k,l,m,n,o,p=c&&c.split("/"),q=x.map,r=q&&q["*"];if(a&&(a=a.split("/"),j=a.length-1,x.nodeIdCompat&&jsSuffixRegExp.test(a[j])&&(a[j]=a[j].replace(jsSuffixRegExp,"")),"."===a[0].charAt(0)&&p&&(o=p.slice(0,p.length-1),a=o.concat(a)),b(a),a=a.join("/")),d&&q&&(p||r)){f=a.split("/");a:for(g=f.length;g>0;g-=1){if(i=f.slice(0,g).join("/"),p)for(h=p.length;h>0;h-=1)if((e=getOwn(q,p.slice(0,h).join("/")))&&(e=getOwn(e,i))){k=e,l=g;break a}!m&&r&&getOwn(r,i)&&(m=getOwn(r,i),n=g)}!k&&m&&(k=m,l=n),k&&(f.splice(0,l,k),a=f.join("/"))}return getOwn(x.pkgs,a)||a}function d(a){isBrowser&&each(scripts(),function(b){if(b.getAttribute("data-requiremodule")===a&&b.getAttribute("data-requirecontext")===u.contextName)return b.parentNode.removeChild(b),!0})}function e(a){var b=getOwn(x.paths,a);if(b&&isArray(b)&&b.length>1)return b.shift(),u.require.undef(a),u.makeRequire(null,{skipMap:!0})([a]),!0}function f(a){var b,c=a?a.indexOf("!"):-1;return c>-1&&(b=a.substring(0,c),a=a.substring(c+1,a.length)),[b,a]}function g(a,b,d,e){var g,h,i,j,k=null,l=b?b.name:null,m=a,n=!0,o="";return a||(n=!1,a="_@r"+(F+=1)),j=f(a),k=j[0],a=j[1],k&&(k=c(k,l,e),h=getOwn(C,k)),a&&(k?o=h&&h.normalize?h.normalize(a,function(a){return c(a,l,e)}):-1===a.indexOf("!")?c(a,l,e):a:(o=c(a,l,e),j=f(o),k=j[0],o=j[1],d=!0,g=u.nameToUrl(o))),i=!k||h||d?"":"_unnormalized"+(G+=1),{prefix:k,name:o,parentMap:b,unnormalized:!!i,url:g,originalName:m,isDefine:n,id:(k?k+"!"+o:o)+i}}function h(a){var b=a.id,c=getOwn(y,b);return c||(c=y[b]=new u.Module(a)),c}function i(a,b,c){var d=a.id,e=getOwn(y,d);!hasProp(C,d)||e&&!e.defineEmitComplete?(e=h(a),e.error&&"error"===b?c(e.error):e.on(b,c)):"defined"===b&&c(C[d])}function j(a,b){var c=a.requireModules,d=!1;b?b(a):(each(c,function(b){var c=getOwn(y,b);c&&(c.error=a,c.events.error&&(d=!0,c.emit("error",a)))}),d||req.onError(a))}function k(){globalDefQueue.length&&(each(globalDefQueue,function(a){var b=a[0];"string"==typeof b&&(u.defQueueMap[b]=!0),B.push(a)}),globalDefQueue=[])}function l(a){delete y[a],delete z[a]}function m(a,b,c){var d=a.map.id;a.error?a.emit("error",a.error):(b[d]=!0,each(a.depMaps,function(d,e){var f=d.id,g=getOwn(y,f);!g||a.depMatched[e]||c[f]||(getOwn(b,f)?(a.defineDep(e,C[f]),a.check()):m(g,b,c))}),c[d]=!0)}function n(){var a,b,c=1e3*x.waitSeconds,f=c&&u.startTime+c<(new Date).getTime(),g=[],h=[],i=!1,k=!0;if(!s){if(s=!0,eachProp(z,function(a){var c=a.map,j=c.id;if(a.enabled&&(c.isDefine||h.push(a),!a.error))if(!a.inited&&f)e(j)?(b=!0,i=!0):(g.push(j),d(j));else if(!a.inited&&a.fetched&&c.isDefine&&(i=!0,!c.prefix))return k=!1}),f&&g.length)return a=makeError("timeout","Load timeout for modules: "+g,null,g),a.contextName=u.contextName,j(a);k&&each(h,function(a){m(a,{},{})}),f&&!b||!i||!isBrowser&&!isWebWorker||w||(w=setTimeout(function(){w=0,n()},50)),s=!1}}function o(a){hasProp(C,a[0])||h(g(a[0],null,!0)).init(a[1],a[2])}function p(a,b,c,d){a.detachEvent&&!isOpera?d&&a.detachEvent(d,b):a.removeEventListener(c,b,!1)}function q(a){var b=a.currentTarget||a.srcElement;return p(b,u.onScriptLoad,"load","onreadystatechange"),p(b,u.onScriptError,"error"),{node:b,id:b&&b.getAttribute("data-requiremodule")}}function r(){var a;for(k();B.length;){if(a=B.shift(),null===a[0])return j(makeError("mismatch","Mismatched anonymous define() module: "+a[a.length-1]));o(a)}u.defQueueMap={}}
var s,t,u,v,w,x={waitSeconds:7,baseUrl:"./",paths:{},bundles:{},pkgs:{},shim:{},config:{}},y={},z={},A={},B=[],C={},D={},E={},F=1,G=1;return v={require:function(a){return a.require?a.require:a.require=u.makeRequire(a.map)},exports:function(a){if(a.usingExports=!0,a.map.isDefine)return a.exports?C[a.map.id]=a.exports:a.exports=C[a.map.id]={}},module:function(a){return a.module?a.module:a.module={id:a.map.id,uri:a.map.url,config:function(){return getOwn(x.config,a.map.id)||{}},exports:a.exports||(a.exports={})}}},t=function(a){this.events=getOwn(A,a.id)||{},this.map=a,this.shim=getOwn(x.shim,a.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},t.prototype={init:function(a,b,c,d){d=d||{},this.inited||(this.factory=b,c?this.on("error",c):this.events.error&&(c=bind(this,function(a){this.emit("error",a)})),this.depMaps=a&&a.slice(0),this.errback=c,this.inited=!0,this.ignore=d.ignore,d.enabled||this.enabled?this.enable():this.check())},defineDep:function(a,b){this.depMatched[a]||(this.depMatched[a]=!0,this.depCount-=1,this.depExports[a]=b)},fetch:function(){if(!this.fetched){this.fetched=!0,u.startTime=(new Date).getTime();var a=this.map;if(!this.shim)return a.prefix?this.callPlugin():this.load();u.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return a.prefix?this.callPlugin():this.load()}))}},load:function(){var a=this.map.url;D[a]||(D[a]=!0,u.load(this.map.id,a))},check:function(){if(this.enabled&&!this.enabling){var a,b,c=this.map.id,d=this.depExports,e=this.exports,f=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(f)){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)try{e=u.execCb(c,f,d,e)}catch(b){a=b}else e=u.execCb(c,f,d,e);if(this.map.isDefine&&void 0===e&&(b=this.module,b?e=b.exports:this.usingExports&&(e=this.exports)),a)return a.requireMap=this.map,a.requireModules=this.map.isDefine?[this.map.id]:null,a.requireType=this.map.isDefine?"define":"require",j(this.error=a)}else e=f;if(this.exports=e,this.map.isDefine&&!this.ignore&&(C[c]=e,req.onResourceLoad)){var g=[];each(this.depMaps,function(a){g.push(a.normalizedMap||a)}),req.onResourceLoad(u,this.map,g)}l(c),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else hasProp(u.defQueueMap,c)||this.fetch()}},callPlugin:function(){var a=this.map,b=a.id,d=g(a.prefix);this.depMaps.push(d),i(d,"defined",bind(this,function(d){var e,f,k,m=getOwn(E,this.map.id),n=this.map.name,o=this.map.parentMap?this.map.parentMap.name:null,p=u.makeRequire(a.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(d.normalize&&(n=d.normalize(n,function(a){return c(a,o,!0)})||""),f=g(a.prefix+"!"+n,this.map.parentMap),i(f,"defined",bind(this,function(a){this.map.normalizedMap=f,this.init([],function(){return a},null,{enabled:!0,ignore:!0})})),void((k=getOwn(y,f.id))&&(this.depMaps.push(f),this.events.error&&k.on("error",bind(this,function(a){this.emit("error",a)})),k.enable()))):m?(this.map.url=u.nameToUrl(m),void this.load()):(e=bind(this,function(a){this.init([],function(){return a},null,{enabled:!0})}),e.error=bind(this,function(a){this.inited=!0,this.error=a,a.requireModules=[b],eachProp(y,function(a){0===a.map.id.indexOf(b+"_unnormalized")&&l(a.map.id)}),j(a)}),e.fromText=bind(this,function(c,d){var f=a.name,i=g(f),k=useInteractive;d&&(c=d),k&&(useInteractive=!1),h(i),hasProp(x.config,b)&&(x.config[f]=x.config[b]);try{req.exec(c)}catch(a){return j(makeError("fromtexteval","fromText eval for "+b+" failed: "+a,a,[b]))}k&&(useInteractive=!0),this.depMaps.push(i),u.completeLoad(f),p([f],e)}),void d.load(a.name,p,e,x))})),u.enable(d,this),this.pluginMaps[d.id]=d},enable:function(){z[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(a,b){var c,d,e;if("string"==typeof a){if(a=g(a,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[b]=a,e=getOwn(v,a.id))return void(this.depExports[b]=e(this));this.depCount+=1,i(a,"defined",bind(this,function(a){this.undefed||(this.defineDep(b,a),this.check())})),this.errback?i(a,"error",bind(this,this.errback)):this.events.error&&i(a,"error",bind(this,function(a){this.emit("error",a)}))}c=a.id,d=y[c],hasProp(v,c)||!d||d.enabled||u.enable(a,this)})),eachProp(this.pluginMaps,bind(this,function(a){var b=getOwn(y,a.id);b&&!b.enabled&&u.enable(a,this)})),this.enabling=!1,this.check()},on:function(a,b){var c=this.events[a];c||(c=this.events[a]=[]),c.push(b)},emit:function(a,b){each(this.events[a],function(a){a(b)}),"error"===a&&delete this.events[a]}},u={config:x,contextName:a,registry:y,defined:C,urlFetched:D,defQueue:B,defQueueMap:{},Module:t,makeModuleMap:g,nextTick:req.nextTick,onError:j,configure:function(a){if(a.baseUrl&&"/"!==a.baseUrl.charAt(a.baseUrl.length-1)&&(a.baseUrl+="/"),"string"==typeof a.urlArgs){var b=a.urlArgs;a.urlArgs=function(a,c){return(-1===c.indexOf("?")?"?":"&")+b}}var c=x.shim,d={paths:!0,bundles:!0,config:!0,map:!0};eachProp(a,function(a,b){d[b]?(x[b]||(x[b]={}),mixin(x[b],a,!0,!0)):x[b]=a}),a.bundles&&eachProp(a.bundles,function(a,b){each(a,function(a){a!==b&&(E[a]=b)})}),a.shim&&(eachProp(a.shim,function(a,b){isArray(a)&&(a={deps:a}),!a.exports&&!a.init||a.exportsFn||(a.exportsFn=u.makeShimExports(a)),c[b]=a}),x.shim=c),a.packages&&each(a.packages,function(a){var b,c;a="string"==typeof a?{name:a}:a,c=a.name,b=a.location,b&&(x.paths[c]=a.location),x.pkgs[c]=a.name+"/"+(a.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}),eachProp(y,function(a,b){a.inited||a.map.unnormalized||(a.map=g(b,null,!0))}),(a.deps||a.callback)&&u.require(a.deps||[],a.callback)},makeShimExports:function(a){function b(){var b;return a.init&&(b=a.init.apply(global,arguments)),b||a.exports&&getGlobal(a.exports)}return b},makeRequire:function(b,e){function f(c,d,i){var k,l,m;return e.enableBuildCallback&&d&&isFunction(d)&&(d.__requireJsBuild=!0),"string"==typeof c?isFunction(d)?j(makeError("requireargs","Invalid require call"),i):b&&hasProp(v,c)?v[c](y[b.id]):req.get?req.get(u,c,b,f):(l=g(c,b,!1,!0),k=l.id,hasProp(C,k)?C[k]:j(makeError("notloaded",'Module name "'+k+'" has not been loaded yet for context: '+a+(b?"":". Use require([])")))):(r(),u.nextTick(function(){r(),m=h(g(null,b)),m.skipMap=e.skipMap,m.init(c,d,i,{enabled:!0}),n()}),f)}return e=e||{},mixin(f,{isBrowser:isBrowser,toUrl:function(a){var d,e=a.lastIndexOf("."),f=a.split("/")[0],g="."===f||".."===f;return-1!==e&&(!g||e>1)&&(d=a.substring(e,a.length),a=a.substring(0,e)),u.nameToUrl(c(a,b&&b.id,!0),d,!0)},defined:function(a){return hasProp(C,g(a,b,!1,!0).id)},specified:function(a){return a=g(a,b,!1,!0).id,hasProp(C,a)||hasProp(y,a)}}),b||(f.undef=function(a){k();var c=g(a,b,!0),e=getOwn(y,a);e.undefed=!0,d(a),delete C[a],delete D[c.url],delete A[a],eachReverse(B,function(b,c){b[0]===a&&B.splice(c,1)}),delete u.defQueueMap[a],e&&(e.events.defined&&(A[a]=e.events),l(a))}),f},enable:function(a){getOwn(y,a.id)&&h(a).enable()},completeLoad:function(a){var b,c,d,f=getOwn(x.shim,a)||{},g=f.exports;for(k();B.length;){if(c=B.shift(),null===c[0]){if(c[0]=a,b)break;b=!0}else c[0]===a&&(b=!0);o(c)}if(u.defQueueMap={},d=getOwn(y,a),!b&&!hasProp(C,a)&&d&&!d.inited){if(!(!x.enforceDefine||g&&getGlobal(g)))return e(a)?void 0:j(makeError("nodefine","No define call for "+a,null,[a]));o([a,f.deps||[],f.exportsFn])}n()},nameToUrl:function(a,b,c){var d,e,f,g,h,i,j,k=getOwn(x.pkgs,a);if(k&&(a=k),j=getOwn(E,a))return u.nameToUrl(j,b,c);if(req.jsExtRegExp.test(a))h=a+(b||"");else{for(d=x.paths,e=a.split("/"),f=e.length;f>0;f-=1)if(g=e.slice(0,f).join("/"),i=getOwn(d,g)){isArray(i)&&(i=i[0]),e.splice(0,f,i);break}h=e.join("/"),h+=b||(/^data\:|^blob\:|\?/.test(h)||c?"":".js"),h=("/"===h.charAt(0)||h.match(/^[\w\+\.\-]+:/)?"":x.baseUrl)+h}return x.urlArgs&&!/^blob\:/.test(h)?h+x.urlArgs(a,h):h},load:function(a,b){req.load(u,a,b)},execCb:function(a,b,c,d){return b.apply(d,c)},onScriptLoad:function(a){if("load"===a.type||readyRegExp.test((a.currentTarget||a.srcElement).readyState)){interactiveScript=null;var b=q(a);u.completeLoad(b.id)}},onScriptError:function(a){var b=q(a);if(!e(b.id)){var c=[];return eachProp(y,function(a,d){0!==d.indexOf("_@r")&&each(a.depMaps,function(a){if(a.id===b.id)return c.push(d),!0})}),j(makeError("scripterror",'Script error for "'+b.id+(c.length?'", needed by: '+c.join(", "):'"'),a,[b.id]))}}},u.require=u.makeRequire(),u}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState?interactiveScript:(eachReverse(scripts(),function(a){if("interactive"===a.readyState)return interactiveScript=a}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.3.2",commentRegExp=/\/\*[\s\S]*?\*\/|([^:"'=]|^)\/\/.*$/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,isBrowser=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if(void 0===define){if(void 0!==requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}void 0===require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(a,b,c,d){var e,f,g=defContextName;return isArray(a)||"string"==typeof a||(f=a,isArray(b)?(a=b,b=c,c=d):a=[]),f&&f.context&&(g=f.context),e=getOwn(contexts,g),e||(e=contexts[g]=req.s.newContext(g)),f&&e.configure(f),e.require(a,b,c)},req.config=function(a){return req(a)},req.nextTick=void 0!==setTimeout?function(a){setTimeout(a,4)}:function(a){a()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(a){req[a]=function(){var b=contexts[defContextName];return b.require[a].apply(b,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],(baseElement=document.getElementsByTagName("base")[0])&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.createNode=function(a,b,c){var d=a.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return d.type=a.scriptType||"text/javascript",d.charset="utf-8",d.async=!0,d},req.load=function(a,b,c){var d,e=a&&a.config||{};if(isBrowser)return d=req.createNode(e,b,c),d.setAttribute("data-requirecontext",a.contextName),d.setAttribute("data-requiremodule",b),!d.attachEvent||d.attachEvent.toString&&d.attachEvent.toString().indexOf("[native code")<0||isOpera?(d.addEventListener("load",a.onScriptLoad,!1),d.addEventListener("error",a.onScriptError,!1)):(useInteractive=!0,d.attachEvent("onreadystatechange",a.onScriptLoad)),d.src=c,e.onNodeCreated&&e.onNodeCreated(d,e,b,c),currentlyAddingScript=d,baseElement?head.insertBefore(d,baseElement):head.appendChild(d),currentlyAddingScript=null,d;if(isWebWorker)try{setTimeout(function(){},0),importScripts(c),a.completeLoad(b)}catch(d){a.onError(makeError("importscripts","importScripts failed for "+b+" at "+c,d,[b]))}},isBrowser&&!cfg.skipDataMain&&eachReverse(scripts(),function(a){if(head||(head=a.parentNode),dataMain=a.getAttribute("data-main"))return mainScript=dataMain,cfg.baseUrl||-1!==mainScript.indexOf("!")||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0}),define=function(a,b,c){var d,e;"string"!=typeof a&&(c=b,b=a,a=null),isArray(b)||(c=b,b=null),!b&&isFunction(c)&&(b=[],c.length&&(c.toString().replace(commentRegExp,commentReplace).replace(cjsRequireRegExp,function(a,c){b.push(c)}),b=(1===c.length?["require"]:["require","exports","module"]).concat(b))),useInteractive&&(d=currentlyAddingScript||getInteractiveScript())&&(a||(a=d.getAttribute("data-requiremodule")),e=contexts[d.getAttribute("data-requirecontext")]),e?(e.defQueue.push([a,b,c]),e.defQueueMap[a]=!0):globalDefQueue.push([a,b,c])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}}(this,"undefined"==typeof setTimeout?void 0:setTimeout);var C={STATUS_NULL:0,STATUS_INVITE_SENT:1,STATUS_1XX_RECEIVED:2,STATUS_INVITE_RECEIVED:3,STATUS_WAITING_FOR_ANSWER:4,STATUS_ANSWERED:5,STATUS_WAITING_FOR_ACK:6,STATUS_CANCELED:7,STATUS_TERMINATED:8,STATUS_CONFIRMED:9,causes:{CONNECTION_ERROR:"Connection Error",REQUEST_TIMEOUT:"Request Timeout",SIP_FAILURE_CODE:"SIP Failure Code",INTERNAL_ERROR:"Internal Error",BUSY:"Busy",REJECTED:"Rejected",REDIRECTED:"Redirected",UNAVAILABLE:"Unavailable",NOT_FOUND:"Not Found",ADDRESS_INCOMPLETE:"Address Incomplete",INCOMPATIBLE_SDP:"Incompatible SDP",MISSING_SDP:"Missing SDP",AUTHENTICATION_ERROR:"Authentication Error",BYE:"Terminated",WEBRTC_ERROR:"WebRTC Error",CANCELED:"Canceled",NO_ANSWER:"No Answer",EXPIRES:"Expires",NO_ACK:"No ACK",DIALOG_ERROR:"Dialog Error",USER_DENIED_MEDIA_ACCESS:"User Denied Media Access",BAD_MEDIA_DESCRIPTION:"Bad Media Description",RTP_TIMEOUT:"RTP Timeout"},SESSION_EXPIRES:3600};
//# sourceMappingURL=voxbone-3.0.min.js.map